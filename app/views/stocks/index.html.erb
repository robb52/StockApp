<div class="container stock">

  <h1>Stocks</h1>

  <table class="table table-bordered table-striped table-hover">
    <thead>
      <tr>
        <th>Ticker</th>
        <th>Current Price</th>
        <th>Company Worth</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @stocks.each do |stock| %>
        <% if stock.user_id == current_user.id %>
         <% begin %>
          <% @stock = StockQuote::Stock.quote(stock.ticker) %>
        <% rescue StandError %>
          <tr>
            <td><%= stock.ticker %></td>
            <td><%= "N/A" %></td>
            <td><%= link_to 'Show', stock %></td>
            <td><%= link_to 'Edit', edit_stock_path(stock) %></td>
            <td><%= link_to 'Destroy', stock, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
         <% next %>
        <% end %>
       
          <tr>
            <td><%= stock.ticker %></td>
            <td><%= @stock.open %></td>
            <td><%= @stock.market_cap %></td>
            <td><%= link_to 'Show', stock, class: "btn btn-outline-primary btn-sm" %></td>
            <td><%= link_to 'Edit', edit_stock_path(stock), class: "btn btn-outline-primary btn-sm" %></td>
            <td><%= link_to 'Destroy', stock, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-outline-danger btn-sm" %></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>

  <br>

  <%= link_to 'New Stock', new_stock_path, class: "btn btn-primary" %>
  
</div>